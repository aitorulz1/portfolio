{"ast":null,"code":"var _jsxFileName = \"/Users/usuario/Desktop/portfolio-aa/src/context/auth/authState.js\",\n  _s = $RefreshSig$();\nimport React, { useReducer } from \"react\";\nimport authContext from \"./authContext\";\nimport authReducer from \"./authReducer\";\nimport clienteAxios from \"../../service/axios\";\nimport tokenAuth from \"../../config/token\";\nimport { REGISTRO_EXITOSO, REGISTRO_ERROR, LOGIN_EXITOSO, LOGIN_ERROR, LOGOUT, OBTENER_USUARIO } from \"../../types\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AuthState = props => {\n  _s();\n  const initialState = {\n    token: localStorage.getItem(\"token\"),\n    autenticado: null,\n    usuario: null,\n    mensaje: null\n  };\n  const [state, dispatch] = useReducer(authReducer, initialState);\n\n  // 1. Registra al nuevo usuario\n  const registrarUsuario = async datos => {\n    try {\n      const resultado = await clienteAxios.post(\"/users\", datos);\n\n      // Estoy enviando el TOKEN\n      dispatch({\n        type: REGISTRO_EXITOSO,\n        payload: resultado.data\n      });\n      usuarioAutenticado();\n    } catch (error) {\n      const alerta = {\n        msg: error.response.data.msg,\n        categoria: \"alerta-error\"\n      };\n      dispatch({\n        type: REGISTRO_ERROR,\n        payload: alerta\n      });\n    }\n  };\n\n  // 2. Retorna el usuario autenticado\n  const usuarioAutenticado = async () => {\n    const token = localStorage.getItem(\"token\");\n    if (token) {\n      tokenAuth(token);\n    }\n    try {\n      const respuesta = await clienteAxios.get(\"/auth\");\n      dispatch({\n        type: OBTENER_USUARIO,\n        payload: respuesta.data\n      });\n    } catch (error) {\n      dispatch({\n        type: LOGIN_ERROR\n      });\n    }\n  };\n\n  // 3. Iniciar Sesi贸n\n\n  const iniciarSesion = async datos => {\n    try {\n      const respuesta = await clienteAxios.post(\"/auth\", datos);\n      dispatch({\n        type: LOGIN_EXITOSO,\n        payload: respuesta.data\n      });\n\n      // Traigo el usuario\n      usuarioAutenticado();\n    } catch (error) {\n      const alerta = {\n        msg: error.response.data.msg,\n        categoria: \"alerta-error\"\n      };\n      dispatch({\n        type: LOGIN_ERROR,\n        payload: alerta\n      });\n    }\n  };\n\n  // 4. Cerrar Sesi贸n\n  const cerrarSesion = () => {\n    dispatch({\n      type: LOGOUT\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(authContext.Provider, {\n    value: {\n      token: state.token,\n      autenticado: state.autenticado,\n      usuario: state.usuario,\n      mensaje: state.mensaje,\n      registrarUsuario,\n      usuarioAutenticado,\n      iniciarSesion,\n      cerrarSesion\n    },\n    children: props.children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 107,\n    columnNumber: 5\n  }, this);\n};\n_s(AuthState, \"6JWkGZ32UPfojeNx+xqn8ZU8A0Q=\");\n_c = AuthState;\nexport default AuthState;\nvar _c;\n$RefreshReg$(_c, \"AuthState\");","map":{"version":3,"names":["React","useReducer","authContext","authReducer","clienteAxios","tokenAuth","REGISTRO_EXITOSO","REGISTRO_ERROR","LOGIN_EXITOSO","LOGIN_ERROR","LOGOUT","OBTENER_USUARIO","jsxDEV","_jsxDEV","AuthState","props","_s","initialState","token","localStorage","getItem","autenticado","usuario","mensaje","state","dispatch","registrarUsuario","datos","resultado","post","type","payload","data","usuarioAutenticado","error","alerta","msg","response","categoria","respuesta","get","iniciarSesion","cerrarSesion","Provider","value","children","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/Users/usuario/Desktop/portfolio-aa/src/context/auth/authState.js"],"sourcesContent":["import React, { useReducer } from \"react\";\r\nimport authContext from \"./authContext\";\r\nimport authReducer from \"./authReducer\";\r\n\r\nimport clienteAxios from \"../../service/axios\";\r\n\r\nimport tokenAuth from \"../../config/token\";\r\n\r\nimport {\r\n  REGISTRO_EXITOSO,\r\n  REGISTRO_ERROR,\r\n  LOGIN_EXITOSO,\r\n  LOGIN_ERROR,\r\n  LOGOUT,\r\n  OBTENER_USUARIO,\r\n} from \"../../types\";\r\n\r\nconst AuthState = (props) => {\r\n  const initialState = {\r\n    token: localStorage.getItem(\"token\"),\r\n    autenticado: null,\r\n    usuario: null,\r\n    mensaje: null,\r\n  };\r\n\r\n  const [state, dispatch] = useReducer(authReducer, initialState);\r\n\r\n  // 1. Registra al nuevo usuario\r\n  const registrarUsuario = async (datos) => {\r\n    try {\r\n      const resultado = await clienteAxios.post(\"/users\", datos);\r\n\r\n      // Estoy enviando el TOKEN\r\n      dispatch({\r\n        type: REGISTRO_EXITOSO,\r\n        payload: resultado.data,\r\n      });\r\n\r\n      usuarioAutenticado();\r\n    } catch (error) {\r\n      const alerta = {\r\n        msg: error.response.data.msg,\r\n        categoria: \"alerta-error\",\r\n      };\r\n\r\n      dispatch({\r\n        type: REGISTRO_ERROR,\r\n        payload: alerta,\r\n      });\r\n    }\r\n  };\r\n\r\n  // 2. Retorna el usuario autenticado\r\n  const usuarioAutenticado = async () => {\r\n    const token = localStorage.getItem(\"token\");\r\n    if (token) {\r\n      tokenAuth(token);\r\n    }\r\n\r\n    try {\r\n      const respuesta = await clienteAxios.get(\"/auth\");\r\n      dispatch({\r\n        type: OBTENER_USUARIO,\r\n        payload: respuesta.data,\r\n      });\r\n    } catch (error) {\r\n      dispatch({\r\n        type: LOGIN_ERROR,\r\n      });\r\n    }\r\n  };\r\n\r\n  // 3. Iniciar Sesi贸n\r\n\r\n  const iniciarSesion = async (datos) => {\r\n    try {\r\n      const respuesta = await clienteAxios.post(\"/auth\", datos);\r\n\r\n      dispatch({\r\n        type: LOGIN_EXITOSO,\r\n        payload: respuesta.data,\r\n      });\r\n\r\n      // Traigo el usuario\r\n      usuarioAutenticado();\r\n    } catch (error) {\r\n      const alerta = {\r\n        msg: error.response.data.msg,\r\n        categoria: \"alerta-error\",\r\n      };\r\n\r\n      dispatch({\r\n        type: LOGIN_ERROR,\r\n        payload: alerta,\r\n      });\r\n    }\r\n  };\r\n\r\n  // 4. Cerrar Sesi贸n\r\n  const cerrarSesion = () => {\r\n    dispatch({\r\n      type: LOGOUT,\r\n    });\r\n  };\r\n\r\n  return (\r\n    <authContext.Provider\r\n      value={{\r\n        token: state.token,\r\n        autenticado: state.autenticado,\r\n        usuario: state.usuario,\r\n        mensaje: state.mensaje,\r\n        registrarUsuario,\r\n        usuarioAutenticado,\r\n        iniciarSesion,\r\n        cerrarSesion,\r\n      }}\r\n    >\r\n      {props.children}\r\n    </authContext.Provider>\r\n  );\r\n};\r\n\r\nexport default AuthState;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}